<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel ejolie.ro</title>
    <style>
        body { font-family: Arial; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5; }
        .header { background: #1a5490; color: white; padding: 20px; border-radius: 5px; margin-bottom: 20px; }
        .auth-box { background: white; padding: 20px; margin-bottom: 20px; border-radius: 5px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; }
        input, textarea, select { width: 100%; padding: 10px; font-size: 14px; border: 1px solid #ddd; border-radius: 3px; box-sizing: border-box; }
        textarea { min-height: 100px; }
        .btn { padding: 10px 20px; border: none; border-radius: 3px; cursor: pointer; font-weight: bold; margin-right: 10px; }
        .btn-save { background: #28a745; color: white; }
        .btn-save:hover { background: #218838; }
        .btn-delete { background: #dc3545; color: white; font-size: 12px; padding: 5px 10px; }
        .notification { padding: 15px; margin-bottom: 20px; border-radius: 3px; display: none; }
        .notification.success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .notification.error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid #ddd; flex-wrap: wrap; }
        .tab-button { padding: 10px 20px; background: none; border: none; cursor: pointer; border-bottom: 3px solid transparent; font-weight: bold; }
        .tab-button.active { border-bottom-color: #1a5490; color: #1a5490; }
        .tab-content { display: none; background: white; padding: 20px; border-radius: 5px; }
        .tab-content.active { display: block; }
        .faq-item { background: #f9f9f9; padding: 15px; margin-bottom: 10px; border-radius: 3px; border-left: 4px solid #1a5490; }
        .faq-item h4 { margin: 0 0 5px 0; color: #1a5490; }
        .faq-item p { margin: 5px 0; color: #333; }
    </style>
</head>
<body>
    <div class="header">
        <h1>âš™ï¸ Admin Panel ejolie.ro</h1>
        <p>EditeazÄƒ datele chatbot-ului - SUPER UÈ˜OR!</p>
    </div>

    <div class="auth-box">
        <div class="form-group">
            <label for="adminPassword">Admin Password:</label>
            <input type="password" id="adminPassword" placeholder="admin123">
        </div>
        <button class="btn btn-save" onclick="checkPassword()">VerificÄƒ Parola</button>
        <div id="notification" class="notification"></div>
    </div>

    <div id="adminContent" style="display: none;">
        <div class="tabs">
            <button class="tab-button active" onclick="showTab('logistics')">ğŸ“‹ Logistics</button>
            <button class="tab-button" onclick="showTab('occasions')">ğŸ­ Occasions</button>
            <button class="tab-button" onclick="showTab('faq')">ğŸ’¬ FAQ</button>
            <button class="tab-button" onclick="showTab('custom_rules')">âš™ï¸ Custom Rules</button>
        </div>

        <!-- TAB: LOGISTICS -->
        <div id="logistics" class="tab-content active">
            <h2>InformaÈ›ii Livrare & Contact</h2>

            <div class="form-group">
                <label>Shipping Cost (lei):</label>
                <input type="number" id="shipping_cost" placeholder="0">
            </div>

            <div class="form-group">
                <label>Shipping Days:</label>
                <input type="text" id="shipping_days" placeholder="24-48 ore">
            </div>

            <div class="form-group">
                <label>Business Hours:</label>
                <input type="text" id="business_hours" placeholder="Luni - Vineri, 09:00 - 18:00">
            </div>

            <div class="form-group">
                <label>Telefon:</label>
                <input type="text" id="phone" placeholder="0757 10 51 51">
            </div>

            <div class="form-group">
                <label>Email:</label>
                <input type="email" id="email" placeholder="contact@ejolie.ro">
            </div>

            <div class="form-group">
                <label>Politica de Retur (text liber):</label>
                <textarea id="return_policy" placeholder="Scrie politica de retur..."></textarea>
            </div>

            <button class="btn btn-save" onclick="saveConfig()">ğŸ’¾ SalveazÄƒ Logistics</button>
        </div>

        <!-- TAB: OCCASIONS -->
        <div id="occasions" class="tab-content">
            <h2>Ocazii - Categorii de Rochii</h2>
            <p><strong>AdaugÄƒ categorii de ocazii.</strong> Bot-ul va folosi acestea pentru recomandÄƒri.</p>

            <div style="margin-bottom: 20px; background: #f0f0f0; padding: 15px; border-radius: 3px;">
                <h3>â• AdaugÄƒ Ocazie NouÄƒ</h3>

                <div class="form-group">
                    <label>Nume Ocazie (ex: NuntÄƒ, Botez, etc):</label>
                    <input type="text" id="new_occasion_name" placeholder="Ex: Rochii de nuntÄƒ">
                </div>

                <div class="form-group">
                    <label>Descriere:</label>
                    <textarea id="new_occasion_desc" placeholder="Ex: Rochii sofisticate pentru mireasÄƒ È™i oaspeÈ›i..."></textarea>
                </div>

                <div class="form-group">
                    <label>Culori Sugerate (separate cu virgulÄƒ):</label>
                    <input type="text" id="new_occasion_colors" placeholder="Ex: alb, crem, bleu, roz">
                </div>

                <div class="form-group">
                    <label>Style Tips:</label>
                    <input type="text" id="new_occasion_tips" placeholder="Ex: ElegantÄƒ, material premium, decoleu discret">
                </div>

                <button class="btn btn-save" onclick="addOccasion()">â• AdaugÄƒ Ocazie</button>
            </div>

            <h3>ğŸ­ Ocazii Existente:</h3>
            <div id="occasions_list"></div>

            <button class="btn btn-save" onclick="saveOccasions()" style="margin-top: 20px;">ğŸ’¾ SalveazÄƒ Ocazii</button>
        </div>

        <!-- TAB: FAQ -->
        <div id="faq" class="tab-content">
            <h2>FAQ - ÃntrebÄƒri & RÄƒspunsuri</h2>
            <p><strong>AdaugÄƒ Ã®ntrebÄƒri È™i rÄƒspunsuri scurte.</strong> Bot-ul va folosi acestea pentru rÄƒspunsuri rapide.</p>

            <div style="margin-bottom: 20px; background: #f0f0f0; padding: 15px; border-radius: 3px;">
                <h3>â• AdaugÄƒ Ãntrebare NouÄƒ</h3>

                <div class="form-group">
                    <label>Ãntrebare:</label>
                    <input type="text" id="new_question" placeholder="Ex: Pot returna rochia dacÄƒ nu-mi place?">
                </div>

                <div class="form-group">
                    <label>RÄƒspuns:</label>
                    <textarea id="new_answer" placeholder="Ex: Da, poÈ›i returna Ã®n 14 zile de la primire..."></textarea>
                </div>

                <button class="btn btn-save" onclick="addFAQ()">â• AdaugÄƒ Ãntrebare</button>
            </div>

            <h3>ğŸ’¬ ÃntrebÄƒri Existente:</h3>
            <div id="faq_list"></div>

            <button class="btn btn-save" onclick="saveFAQ()" style="margin-top: 20px;">ğŸ’¾ SalveazÄƒ FAQ</button>
        </div>

        <!-- TAB: CUSTOM RULES -->
        <div id="custom_rules" class="tab-content">
            <h2>âš™ï¸ Reguli Custom pentru Bot</h2>
            <p><strong>AdaugÄƒ reguli È™i informaÈ›ii speciale</strong> pe care bot-ul le va folosi Ã®n rÄƒspunsuri.</p>

            <div style="margin-bottom: 20px; background: #f0f0f0; padding: 15px; border-radius: 3px;">
                <h3>â• AdaugÄƒ RegulÄƒ NouÄƒ</h3>

                <div class="form-group">
                    <label>Tip de RegulÄƒ:</label>
                    <select id="rule_type" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 3px;">
                        <option value="custom_info">ğŸ“ InformaÈ›ie Custom (pentru rÄƒspunsuri)</option>
                        <option value="behavior">ğŸ¤– Comportament Bot (cum sÄƒ rÄƒspundÄƒ)</option>
                        <option value="restriction">â›” RestricÈ›ie (ce NU trebuie sÄƒ facÄƒ)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Titlu RegulÄƒ:</label>
                    <input type="text" id="rule_title" placeholder="Ex: Ãmbracaminte din Asia, Politica de Schimb, etc">
                </div>

                <div class="form-group">
                    <label>ConÈ›inut RegulÄƒ (text liber):</label>
                    <textarea id="rule_content" placeholder="Scrie informaÈ›ia/regula Ã®n detaliu..."></textarea>
                </div>

                <button class="btn btn-save" onclick="addCustomRule()">â• AdaugÄƒ RegulÄƒ</button>
            </div>

            <h3>ğŸ“‹ Reguli Existente:</h3>
            <div id="custom_rules_list"></div>

            <button class="btn btn-save" onclick="saveCustomRules()" style="margin-top: 20px;">ğŸ’¾ SalveazÄƒ Reguli</button>
        </div>
    </div>

    <script>
        let currentPassword = '';
        let faqList = [];
        let occasionsList = [];
        let customRulesList = [];

        function showNotification(message, type) {
            const notif = document.getElementById('notification');
            notif.textContent = message;
            notif.className = 'notification ' + type;
            notif.style.display = 'block';
            setTimeout(() => { notif.style.display = 'none'; }, 3000);
        }

        function checkPassword() {
            currentPassword = document.getElementById('adminPassword').value;
            if (currentPassword.length < 3) {
                showNotification('âŒ Parola prea scurtÄƒ!', 'error');
                return;
            }
            document.getElementById('adminContent').style.display = 'block';
            loadConfig();
            showNotification('âœ… Autentificare reuÈ™itÄƒ!', 'success');
        }

        function loadConfig() {
            fetch('/api/config')
                .then(r => r.json())
                .then(config => {
                    // Logistics
                    document.getElementById('shipping_cost').value = config.logistics?.shipping?.cost_standard || 0;
                    document.getElementById('shipping_days').value = config.logistics?.shipping?.days || '';
                    document.getElementById('business_hours').value = config.logistics?.contact?.hours || '';
                    document.getElementById('phone').value = config.logistics?.contact?.phone || '';
                    document.getElementById('email').value = config.logistics?.contact?.email || '';
                    document.getElementById('return_policy').value = config.logistics?.return_policy || '';

                    // Occasions, FAQ, Custom Rules
                    occasionsList = config.occasions || [];
                    faqList = config.faq || [];
                    customRulesList = config.custom_rules || [];
                    displayOccasions();
                    displayFAQ();
                    displayCustomRules();
                });
        }

        // ===== OCCASIONS FUNCTIONS =====
        function displayOccasions() {
            const occDiv = document.getElementById('occasions_list');
            occDiv.innerHTML = '';

            if (occasionsList.length === 0) {
                occDiv.innerHTML = '<p style="color: #999;">Nu existÄƒ ocazii. AdaugÄƒ una!</p>';
                return;
            }

            occasionsList.forEach((item, index) => {
                occDiv.innerHTML += `
                    <div class="faq-item">
                        <h4>ğŸ­ ${item.name}</h4>
                        <p><strong>Descriere:</strong> ${item.description}</p>
                        <p><strong>Culori Sugerate:</strong> ${item.color_suggestions?.join(', ') || 'N/A'}</p>
                        <p><strong>Style Tips:</strong> ${item.style_tips}</p>
                        <button class="btn btn-delete" onclick="deleteOccasion(${index})">ğŸ—‘ï¸ È˜terge</button>
                    </div>
                `;
            });
        }

        function addOccasion() {
            const name = document.getElementById('new_occasion_name').value.trim();
            const desc = document.getElementById('new_occasion_desc').value.trim();
            const colors = document.getElementById('new_occasion_colors').value.split(',').map(c => c.trim()).filter(c => c);
            const tips = document.getElementById('new_occasion_tips').value.trim();

            if (!name || !desc) {
                showNotification('âŒ CompleteazÄƒ nume È™i descriere!', 'error');
                return;
            }

            occasionsList.push({ 
                id: name.toLowerCase().replace(/\s+/g, '_'),
                name, 
                description: desc,
                color_suggestions: colors,
                style_tips: tips
            });

            document.getElementById('new_occasion_name').value = '';
            document.getElementById('new_occasion_desc').value = '';
            document.getElementById('new_occasion_colors').value = '';
            document.getElementById('new_occasion_tips').value = '';
            displayOccasions();
            showNotification('âœ… Ocazie adÄƒugatÄƒ!', 'success');
        }

        function deleteOccasion(index) {
            occasionsList.splice(index, 1);
            displayOccasions();
            showNotification('ğŸ—‘ï¸ È˜terse!', 'success');
        }

        // ===== FAQ FUNCTIONS =====
        function displayFAQ() {
            const faqDiv = document.getElementById('faq_list');
            faqDiv.innerHTML = '';

            if (faqList.length === 0) {
                faqDiv.innerHTML = '<p style="color: #999;">Nu existÄƒ Ã®ntrebÄƒri. AdaugÄƒ una!</p>';
                return;
            }

            faqList.forEach((item, index) => {
                faqDiv.innerHTML += `
                    <div class="faq-item">
                        <h4>â“ ${item.question}</h4>
                        <p>${item.answer}</p>
                        <button class="btn btn-delete" onclick="deleteFAQ(${index})">ğŸ—‘ï¸ È˜terge</button>
                    </div>
                `;
            });
        }

        function addFAQ() {
            const question = document.getElementById('new_question').value.trim();
            const answer = document.getElementById('new_answer').value.trim();

            if (!question || !answer) {
                showNotification('âŒ CompleteazÄƒ Ã®ntrebarea È™i rÄƒspunsul!', 'error');
                return;
            }

            faqList.push({ question, answer });
            document.getElementById('new_question').value = '';
            document.getElementById('new_answer').value = '';
            displayFAQ();
            showNotification('âœ… Ãntrebare adÄƒugatÄƒ!', 'success');
        }

        function deleteFAQ(index) {
            faqList.splice(index, 1);
            displayFAQ();
            showNotification('ğŸ—‘ï¸ È˜terse!', 'success');
        }

        // ===== CUSTOM RULES FUNCTIONS =====
        function displayCustomRules() {
            const rulesDiv = document.getElementById('custom_rules_list');
            rulesDiv.innerHTML = '';

            if (customRulesList.length === 0) {
                rulesDiv.innerHTML = '<p style="color: #999;">Nu existÄƒ reguli. AdaugÄƒ una!</p>';
                return;
            }

            customRulesList.forEach((item, index) => {
                const icons = {
                    'custom_info': 'ğŸ“',
                    'behavior': 'ğŸ¤–',
                    'restriction': 'â›”'
                };
                const icon = icons[item.type] || 'âš™ï¸';

                rulesDiv.innerHTML += `
                    <div class="faq-item">
                        <h4>${icon} ${item.title}</h4>
                        <p><strong>Tip:</strong> ${item.type}</p>
                        <p>${item.content}</p>
                        <button class="btn btn-delete" onclick="deleteCustomRule(${index})">ğŸ—‘ï¸ È˜terge</button>
                    </div>
                `;
            });
        }

        function addCustomRule() {
            const type = document.getElementById('rule_type').value;
            const title = document.getElementById('rule_title').value.trim();
            const content = document.getElementById('rule_content').value.trim();

            if (!title || !content) {
                showNotification('âŒ CompleteazÄƒ titlu È™i conÈ›inut!', 'error');
                return;
            }

            customRulesList.push({ type, title, content });
            document.getElementById('rule_title').value = '';
            document.getElementById('rule_content').value = '';
            displayCustomRules();
            showNotification('âœ… RegulÄƒ adÄƒugatÄƒ!', 'success');
        }

        function deleteCustomRule(index) {
            customRulesList.splice(index, 1);
            displayCustomRules();
            showNotification('ğŸ—‘ï¸ È˜tersÄƒ!', 'success');
        }

        // ===== SAVE FUNCTIONS =====
        function saveConfig() {
            const config = {
                logistics: {
                    shipping: {
                        cost_standard: parseFloat(document.getElementById('shipping_cost').value) || 0,
                        threshold_free_shipping: 200,
                        days: document.getElementById('shipping_days').value,
                        days_working: "Luni - Vineri"
                    },
                    contact: {
                        phone: document.getElementById('phone').value,
                        email: document.getElementById('email').value,
                        hours: document.getElementById('business_hours').value
                    },
                    payment_methods: ["Card bancar", "Transfer bancar", "PlatÄƒ la livrare"],
                    return_policy: document.getElementById('return_policy').value
                },
                occasions: occasionsList,
                faq: faqList,
                custom_rules: customRulesList
            };

            fetch('/api/admin/save-config', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-Admin-Password': currentPassword
                },
                body: JSON.stringify({ config })
            })
            .then(r => r.json())
            .then(data => {
                if (data.status === 'success') {
                    showNotification('âœ… Logistics salvate!', 'success');
                } else {
                    showNotification('âŒ Eroare: ' + data.error, 'error');
                }
            });
        }

        function saveOccasions() {
            const config = {
                logistics: {
                    shipping: {
                        cost_standard: parseFloat(document.getElementById('shipping_cost').value) || 0,
                        threshold_free_shipping: 200,
                        days: document.getElementById('shipping_days').value,
                        days_working: "Luni - Vineri"
                    },
                    contact: {
                        phone: document.getElementById('phone').value,
                        email: document.getElementById('email').value,
                        hours: document.getElementById('business_hours').value
                    },
                    payment_methods: ["Card bancar", "Transfer bancar", "PlatÄƒ la livrare"],
                    return_policy: document.getElementById('return_policy').value
                },
                occasions: occasionsList,
                faq: faqList,
                custom_rules: customRulesList
            };

            fetch('/api/admin/save-config', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-Admin-Password': currentPassword
                },
                body: JSON.stringify({ config })
            })
            .then(r => r.json())
            .then(data => {
                if (data.status === 'success') {
                    showNotification('âœ… Ocazii salvate!', 'success');
                } else {
                    showNotification('âŒ Eroare: ' + data.error, 'error');
                }
            });
        }

        function saveFAQ() {
            const config = {
                logistics: {
                    shipping: {
                        cost_standard: parseFloat(document.getElementById('shipping_cost').value) || 0,
                        threshold_free_shipping: 200,
                        days: document.getElementById('shipping_days').value,
                        days_working: "Luni - Vineri"
                    },
                    contact: {
                        phone: document.getElementById('phone').value,
                        email: document.getElementById('email').value,
                        hours: document.getElementById('business_hours').value
                    },
                    payment_methods: ["Card bancar", "Transfer bancar", "PlatÄƒ la livrare"],
                    return_policy: document.getElementById('return_policy').value
                },
                occasions: occasionsList,
                faq: faqList,
                custom_rules: customRulesList
            };

            fetch('/api/admin/save-config', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-Admin-Password': currentPassword
                },
                body: JSON.stringify({ config })
            })
            .then(r => r.json())
            .then(data => {
                if (data.status === 'success') {
                    showNotification('âœ… FAQ salvate!', 'success');
                } else {
                    showNotification('âŒ Eroare: ' + data.error, 'error');
                }
            });
        }

        function saveCustomRules() {
            const config = {
                logistics: {
                    shipping: {
                        cost_standard: parseFloat(document.getElementById('shipping_cost').value) || 0,
                        threshold_free_shipping: 200,
                        days: document.getElementById('shipping_days').value,
                        days_working: "Luni - Vineri"
                    },
                    contact: {
                        phone: document.getElementById('phone').value,
                        email: document.getElementById('email').value,
                        hours: document.getElementById('business_hours').value
                    },
                    payment_methods: ["Card bancar", "Transfer bancar", "PlatÄƒ la livrare"],
                    return_policy: document.getElementById('return_policy').value
                },
                occasions: occasionsList,
                faq: faqList,
                custom_rules: customRulesList
            };

            fetch('/api/admin/save-config', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-Admin-Password': currentPassword
                },
                body: JSON.stringify({ config })
            })
            .then(r => r.json())
            .then(data => {
                if (data.status === 'success') {
                    showNotification('âœ… Reguli salvate!', 'success');
                } else {
                    showNotification('âŒ Eroare: ' + data.error, 'error');
                }
            });
        }

        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }
    </script>
</body>
</html>
